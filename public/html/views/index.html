<script type="text/ng-template" id="task-template.html">
  <div class="panel" ng-class="panelClass">
    <div class="panel-heading">
      <h4 class="panel-title">
		<div class='row'>
			<div class='col-sm-6'>
				<span uib-accordion-transclude="headingCol1"><span uib-accordion-header>{{headingCol1}}</span></span>
				<a href tabindex="0" class="accordion-toggle" ng-click="toggleOpen()" uib-accordion-transclude="heading"><span uib-accordion-header>{{heading}}</span></a>
			</div>
			<div class='col-sm-2'>
				<span uib-accordion-transclude="headingCol2"><span uib-accordion-header>{{headingCol2}}</span></span>
			</div>
			<div class='col-sm-4'>
				<span uib-accordion-transclude="headingCol3"><span uib-accordion-header>{{headingCol3}}</span></span>
			</div>
		</div>
      </h4>
    </div>
    <div class="panel-collapse collapse" uib-collapse="!isOpen">
      <div class="panel-body" ng-transclude></div>
    </div>
  </div>
</script>

<div class="container">
  <div class='col-sm-12'>
    <a href="/logout" class="btn btn-ms btn-success pull-right">Sign Out</a>
  </div>
</div>

<div class="title">
    Taskie
</div>

<div class="container">
  <div class="panel panel-default">
    <div class="panel-heading">
      <a class="btn btn-xs" data-type="plus" uib-tooltip="Add a new task" ng-click="showTaskModal()">
        <span class="glyphicon glyphicon-plus"></span>
      </a>
      <b>Tasks In-Progress</b>
    </div>
    <div class="panel-body">
      <uib-accordion close-others=false>
        <uib-accordion-group template-url="task-template.html" ng-repeat="task in tasksInProgress | orderBy: taskGetDueDate" is-open="status.open" panel-class="((dateCompareNow(task.DateDue) > 0) ? 'panel-danger' : ((dateCompareNow(task.DateDue) > -1440) ? 'panel-warning' : 'panel-info'))">
          <uib-accordion-heading-col-1>
			
            <a class="btn btn-xs" ng-click="updateTask(task.TaskID, undefined, undefined, undefined, Constants.STATUS_COMPLETED)" uib-tooltip="Mark this task as complete">
              <span class="glyphicon" ng-class="{'glyphicon-check': task.Status == Constants.STATUS_COMPLETED, 'glyphicon-unchecked': task.Status == Constants.STATUS_INPROGRESS}"></span>
            </a>
			<a class="btn btn-xs" ng-click="showTaskModal(task)" uib-tooltip="Edit this task">
              <span class="glyphicon glyphicon-pencil"></span>
            </a>
          </uib-accordion-heading-col-1>
          <uib-accordion-heading>
            <span uib-tooltip="Expand task details">
              <span class="glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></span>
              <b ng-class="{'strike-through': task.Status == Constants.STATUS_COMPLETED}">{{task.Title}}</b>
            </span>
          </uib-accordion-heading>
		  <uib-accordion-heading-col-2>
			<div class = "btn-toolbar">
				<a class="btn-tag btn btn-xs btn-info" ng-repeat="tag in task.Tags">
				  {{tag}}
				</a>
			</div>
		  </uib-accordion-heading-col-2>
          <uib-accordion-heading-col-3>
            <div class="pull-right">
              <b>{{task.DateDue | date:'EEEE, MMM dd yyyy @ h:mm a'}}&nbsp&nbsp</b>
              <a class="btn btn-xs" ng-click="delTask(task.TaskID)" uib-tooltip="Delete this task">
                <span class="glyphicon glyphicon-remove  glyphicon-task-remove"></span>
              </a>
            </div>
          </uib-accordion-heading-col-3>
          <span ng-class="{'strike-through': task.Status == Constants.STATUS_COMPLETED}">{{task.Description}}</span>
        </uib-accordion-group>
      </uib-accordion>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <b>Tasks Completed</b>
    </div>
    <div class="panel-body">
      <uib-accordion close-others=false>
        <uib-accordion-group template-url="task-template.html" ng-repeat="task in tasksCompleted | orderBy: taskGetModifiedDate:true" is-open="status.open" panel-class="((task.Status == Constants.STATUS_INPROGRESS) ? 'panel-info' : 'panel-default')">
          <uib-accordion-heading-col-1>
            <a class="btn btn-xs" ng-click="updateTask(task.TaskID, undefined, undefined, undefined, Constants.STATUS_INPROGRESS)" uib-tooltip="Mark this task as incomplete">
              <span class="glyphicon" ng-class="{'glyphicon-check': task.Status == Constants.STATUS_COMPLETED, 'glyphicon-unchecked': task.Status == Constants.STATUS_INPROGRESS}"></span>
            </a>
          </uib-accordion-heading-col-1>
          <uib-accordion-heading>
            <span class="glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></span>
            <b ng-class="{'strike-through': task.Status == Constants.STATUS_COMPLETED}">{{task.Title}}</b>
          </uib-accordion-heading>
          <uib-accordion-heading-col-3>
            <div class="pull-right">
              <b>{{task.DateDue | date:'EEEE, MMM d yyyy @ h:mm a'}}&nbsp&nbsp</b>
              <a class="btn btn-xs" ng-click="delTask(task.TaskID)" uib-tooltip="Delete this task">
                <span class="glyphicon glyphicon-remove glyphicon-task-remove"></span>
              </a>
            </div>
          </uib-accordion-heading-col-3>
          <span ng-class="{'strike-through': task.Status == Constants.STATUS_COMPLETED}">{{task.Description}}</span>
        </uib-accordion-group>
      </uib-accordion>
    </div>
  </div>
</div>
